<!-- ÊäΩÂ±âÂÆπÂô® -->
<view class="drawer-container" wx:if="{{showDrawer}}">
    <!-- ÈÅÆÁΩ©Â±Ç -->
    <view class="mask" bindtap="closeDrawer"></view>

    <!-- ÊäΩÂ±â‰∏ª‰Ωì -->
    <view class="drawer-content">
        <!-- Êñ∞Â¢ûËÉ°ÁâåÁ±ªÂûãÈÄâÊã© -->
        <view class="drawer-content-top">
            <view class="win-type-selector">
                <text class="selector-label">ËÉ°ÁâåÔºö</text>
                <view class="type-buttons">
                    <view
                            class="type-btn {{winType === 'Âπ≥ËÉ°' ? 'active' : ''}}"
                            bindtap="selectWinType"
                            data-type="Âπ≥ËÉ°"
                    >
                        Âπ≥ËÉ°
                    </view>
                    <view
                            class="type-btn {{winType === 'Ëá™Êë∏' ? 'active' : ''}}"
                            bindtap="selectWinType"
                            data-type="Ëá™Êë∏"
                    >
                        Ëá™Êë∏
                    </view>
                    <view
                            class="type-btn {{winType === 'Â§öËµ¢ÂÆ∂' ? 'active' : ''}}"
                            bindtap="selectWinType"
                            data-type="Â§öËµ¢ÂÆ∂"
                    >
                        Â§öËµ¢ÂÆ∂
                    </view>
                </view>
            </view>
            <!-- Á¨¨‰∏ÄÈÉ®ÂàÜÔºöÊ†áÈ¢ò+Êç¢‰∫∫ÊåâÈíÆ -->
            <view class="section-header">
                <text class="section-title">üôÇ ÈÄâÊã©Ëµ¢ÂÆ∂</text>
                <text wx:if="{{!changingPlayers}}" class="replace-btn" bindtap="startChangePlayers">üîÑ ÁâåÊ°åÊç¢‰∫∫</text>
                <text wx:else class="replace-btn" bindtap="stopChangePlayers">üçÑ Á°ÆËÆ§</text>
            </view>

            <!-- Á¨¨‰∫åÈÉ®ÂàÜÔºöÁé©ÂÆ∂ÂàóË°® -->
            <block wx:if="{{!changingPlayers}}">
                <view class="players-grid">
                    <view
                            wx:for="{{winPlayers}}"
                            wx:key="id"
                            class="player-card {{item.selected ? 'active' : ''}}"
                            bindtap="selectWinPlayer"
                            data-id="{{item.id}}"
                            data-selected="{{item.selected}}"
                    >
                        <image class="player-avatar" src="{{item.avatar}}"/>
                        <text class="player-name">{{item.username}}</text>
                    </view>
                </view>


                <block
                        wx:for="{{winPlayers}}"
                        wx:key="id"
                >
                    <view

                            wx:if="{{item.lastSelected}}"
                            class="detail-box"
                    >
                        <!-- ÂÜÖÂÆπÂå∫Âüü -->
                        <view class="detail-content">
                            <view class="detail-row">
                                <view class="detail-row-title">
                                    <text>{{item.username}} </text>
                                    <text class="detail-title">ÂæóÂàÜ: </text>
                                </view>

                                <view
                                        class="delete-btn"
                                        bindtap="handleDelete"
                                        data-id="{{item.id}}"
                                        hover-class="delete-btn-hover"
                                >
                                    x
                                </view>
                            </view>
                        </view>
                    </view>
                </block>


                <block wx:if="{{winType !== 'Ëá™Êë∏'}}">
                    <view class="section-header">
                        <text class="section-title">‚òπÔ∏è ÈÄâÊã©ËæìÂÆ∂</text>
                    </view>
                    <view class="players-grid">
                        <view
                                wx:for="{{losePlayers}}"
                                wx:key="id"
                                class="player-card {{item.selected ? 'active' : ''}}"
                                bindtap="selectLosePlayer"
                                data-id="{{item.id}}"
                                data-selected="{{item.selected}}"
                        >
                            <image class="player-avatar" src="{{item.avatar}}"/>
                            <text class="player-name">{{item.username}}</text>
                        </view>
                    </view>
                </block>
            </block>
            <block wx:else>
                <scroll-view scroll-y class="scroll-view-container">
                    <view class="all-players-grid">
                        <view
                                wx:for="{{allPlayers}}"
                                wx:key="id"
                                class="all-player-card {{ item.selected ? 'active' : ''}}"
                                bindtap="selectPlayerToPlay"
                                data-id="{{item.id}}"
                                data-selected="{{item.selected}}"
                        >
                            <image class="player-avatar" src="{{item.avatar}}"/>
                            <text class="player-name">{{item.username}}</text>
                        </view>
                    </view>
                </scroll-view>
            </block>

        </view>

        <view wx:if="{{showButton}}" class="drawer-content-bottom">
            <view class="btn cancel" bindtap="closeDrawer">ÂèñÊ∂à</view>
            <view class="btn confirm" bindtap="closeDrawer">Á°ÆËÆ§Êèê‰∫§</view>
        </view>
    </view>
</view>